{"openapi":"3.0.0","info":{"version":"1.0","title":"Umbrella Management API","description":"Management of Umbrella Identities and Policies."},"externalDocs":{"description":"Version history","url":"https://github.office.opendns.com/lucas-core/umbrella-api-design-meraki/commits"},"tags":[{"name":"Network Devices API","description":"Umbrella Network Device Management","externalDocs":{"description":"Legacy API","url":"https://docs.umbrella.com/developer/networkdevices-api/registration-api-endpoint2/"}},{"name":"Organizations API","description":"Umbrella Organization Information"},{"name":"Policy API","description":"Umbrella Policy Management"},{"name":"Network API","description":"Umbrella Network Management","externalDocs":{"description":"Being developed by the *SP team","url":"https://cisco.jiveon.com/groups/opendns-msp-engineering-team"}}],"paths":{"/v1/organizations":{"get":{"tags":["Organizations API"],"summary":"List organizations","description":"List Organizations available to the current API client. Currently this will return a single Organization. In the future it may be possible to access multiple Umbrella Organizations with a single set of credentials.","operationId":"listOrganizations","responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrganizationsList"}}}},"401":{"$ref":"#/components/responses/Unauthorized"},"403":{"$ref":"#/components/responses/Forbidden"},"500":{"$ref":"#/components/responses/ServerError"}},"security":[{"BasicAuth":[]}]}},"/v1/organizations/{organizationId}/networkdevices":{"post":{"tags":["Network Devices API"],"summary":"Create a network device","operationId":"createNetworkDevice","parameters":[{"$ref":"#/components/parameters/organizationIdParam"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetworkDeviceCreate"}}},"description":"Network Device to be created","required":true},"responses":{"201":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetworkDeviceEntity"}}}},"400":{"$ref":"#/components/responses/BadRequest"},"401":{"$ref":"#/components/responses/Unauthorized"},"403":{"$ref":"#/components/responses/Forbidden"},"404":{"$ref":"#/components/responses/NotFound"},"500":{"$ref":"#/components/responses/ServerError"}},"security":[{"BasicAuth":[]}]},"get":{"tags":["Network Devices API"],"summary":"Retrieve all network devices for the current organization","operationId":"getAllNetworkDevices","parameters":[{"$ref":"#/components/parameters/organizationIdParam"}],"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetworkDeviceEntityList"}}}},"400":{"$ref":"#/components/responses/BadRequest"},"401":{"$ref":"#/components/responses/Unauthorized"},"403":{"$ref":"#/components/responses/Forbidden"},"404":{"$ref":"#/components/responses/NotFound"},"500":{"$ref":"#/components/responses/ServerError"}},"security":[{"BasicAuth":[]}]}},"/v1/organizations/{organizationId}/networkdevices/{originId}":{"patch":{"tags":["Network Devices API"],"summary":"Update a network device","operationId":"updateNetworkDevice","parameters":[{"$ref":"#/components/parameters/organizationIdParam"},{"$ref":"#/components/parameters/networkDeviceOriginIdParam"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetworkDevicePatch"}},"application/merge-patch+json":{"schema":{"$ref":"#/components/schemas/NetworkDevicePatch"}}},"description":"Properties of the Network Device to be updated","required":true},"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetworkDeviceEntity"}}}},"400":{"$ref":"#/components/responses/BadRequest"},"401":{"$ref":"#/components/responses/Unauthorized"},"403":{"$ref":"#/components/responses/Forbidden"},"404":{"$ref":"#/components/responses/NotFound"},"500":{"$ref":"#/components/responses/ServerError"}},"security":[{"BasicAuth":[]}]},"get":{"tags":["Network Devices API"],"summary":"Retrieve an existing network device","operationId":"getNetworkDevice","parameters":[{"$ref":"#/components/parameters/organizationIdParam"},{"$ref":"#/components/parameters/networkDeviceOriginIdParam"}],"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetworkDeviceEntity"}}}},"400":{"$ref":"#/components/responses/BadRequest"},"401":{"$ref":"#/components/responses/Unauthorized"},"403":{"$ref":"#/components/responses/Forbidden"},"404":{"$ref":"#/components/responses/NotFound"},"500":{"$ref":"#/components/responses/ServerError"}},"security":[{"BasicAuth":[]}]},"delete":{"tags":["Network Devices API"],"summary":"Remove an existing network device","operationId":"deleteNetworkDevice","parameters":[{"$ref":"#/components/parameters/organizationIdParam"},{"$ref":"#/components/parameters/networkDeviceOriginIdParam"}],"responses":{"204":{"description":"Success. No body"},"400":{"$ref":"#/components/responses/BadRequest"},"401":{"$ref":"#/components/responses/Unauthorized"},"403":{"$ref":"#/components/responses/Forbidden"},"404":{"$ref":"#/components/responses/NotFound"},"500":{"$ref":"#/components/responses/ServerError"}},"security":[{"BasicAuth":[]}]}},"/v1/organizations/{organizationId}/networkdevices/{originId}/policies":{"get":{"tags":["Network Devices API"],"summary":"List the Policies associated with a Network Device","operationId":"listNetworkDevicePolicies","parameters":[{"$ref":"#/components/parameters/organizationIdParam"},{"$ref":"#/components/parameters/networkDeviceOriginIdParam"}],"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OriginPolicyAssociationList"}}}},"400":{"$ref":"#/components/responses/BadRequest"},"401":{"$ref":"#/components/responses/Unauthorized"},"403":{"$ref":"#/components/responses/Forbidden"},"404":{"$ref":"#/components/responses/NotFound"},"500":{"$ref":"#/components/responses/ServerError"}},"security":[{"BasicAuth":[]}]}},"/v1/organizations/{organizationId}/policies":{"get":{"tags":["Policy API"],"summary":"List Policies","description":"List DNS and web policies, if no filters are supplied then only DNS policies accessible with the current credentials will be returned.","operationId":"listPolicies","parameters":[{"$ref":"#/components/parameters/organizationIdParam"},{"$ref":"#/components/parameters/paginationPageParam"},{"$ref":"#/components/parameters/paginationLimitParam"},{"$ref":"#/components/parameters/policyTypeParam"}],"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PolicyList"}}}},"400":{"$ref":"#/components/responses/BadRequest"},"401":{"$ref":"#/components/responses/Unauthorized"},"403":{"$ref":"#/components/responses/Forbidden"},"404":{"$ref":"#/components/responses/NotFound"},"500":{"$ref":"#/components/responses/ServerError"}},"security":[{"BasicAuth":[]}]}},"/v1/organizations/{organizationId}/policies/{policyId}/identities/{originId}":{"put":{"tags":["Policy API"],"description":"Policy changes can take up to 20 minutes to take affect globally. Additionally, for DNS policies, TTLs, caching, and session re-use may cause some devices and domains to appear to take longer to update.","summary":"Add an Identity to a directly applied DNS or web policy","operationId":"putPolicyIdentities","parameters":[{"$ref":"#/components/parameters/organizationIdParam"},{"$ref":"#/components/parameters/networkDeviceOriginIdParam"},{"$ref":"#/components/parameters/policyIdParam"}],"responses":{"200":{"description":"Success. OriginId in desired state"},"400":{"$ref":"#/components/responses/BadRequest"},"401":{"$ref":"#/components/responses/Unauthorized"},"403":{"$ref":"#/components/responses/Forbidden"},"404":{"$ref":"#/components/responses/NotFound"},"500":{"$ref":"#/components/responses/ServerError"}},"security":[{"BasicAuth":[]}]},"delete":{"tags":["Policy API"],"description":"Policy changes can take up to 20 minutes to take affect globally. Additionally, for DNS policies, TTLs, caching, and session re-use may cause some devices and domains to appear to take longer to update.","summary":"Remove an Identity from a directly applied DNS or web policy","operationId":"deletePolicyIdentities","parameters":[{"$ref":"#/components/parameters/organizationIdParam"},{"$ref":"#/components/parameters/networkDeviceOriginIdParam"},{"$ref":"#/components/parameters/policyIdParam"}],"responses":{"200":{"description":"Success. OriginId in desired state"},"400":{"$ref":"#/components/responses/BadRequest"},"401":{"$ref":"#/components/responses/Unauthorized"},"403":{"$ref":"#/components/responses/Forbidden"},"404":{"$ref":"#/components/responses/NotFound"},"500":{"$ref":"#/components/responses/ServerError"}},"security":[{"BasicAuth":[]}]}}},"servers":[{"url":"https://management.api.umbrella.com/"}],"components":{"parameters":{"organizationIdParam":{"name":"organizationId","in":"path","description":"Id of the Organization owning the resources","required":true,"schema":{"type":"integer","format":"int32","minimum":1}},"networkDeviceOriginIdParam":{"name":"originId","in":"path","description":"originID of the identity to remove from the DNS or web policy","required":true,"schema":{"type":"integer","format":"int32","minimum":1}},"paginationPageParam":{"name":"page","in":"query","description":"Start of the page","required":false,"schema":{"type":"integer","format":"int32","minimum":1,"default":1}},"paginationLimitParam":{"name":"limit","in":"query","description":"Number of items to return","required":false,"schema":{"type":"integer","format":"int32","minimum":1,"maximum":100,"default":100}},"policyTypeParam":{"name":"type","in":"query","description":"The type of policies to be returned (either DNS or web)","required":false,"schema":{"type":"string","default":"dns"}},"policyIdParam":{"name":"policyId","in":"path","description":"ID of the DNS or web policy to act upon","required":true,"schema":{"type":"integer","format":"int32","minimum":1}}},"responses":{"NotFound":{"description":"Not Found- A resource specified in the URL was not found","content":{"*/*":{"schema":{"type":"object","minProperties":3,"required":["statusCode","error","txId"],"properties":{"statusCode":{"type":"integer","example":404,"description":"the http error code returned."},"error":{"type":"string","example":"Not Found","description":"a brief description of the error"},"txId":{"type":"string","example":"86e189a6-0124-47d3-a32c-25ff3f07deaf","description":"a unique hex number that can be used for debugging"}}}}}},"Unauthorized":{"description":"Unauthorized- The authorization header is missing or the token is unauthorized","content":{"*/*":{"schema":{"type":"object","minProperties":3,"required":["statusCode","error","txId"],"properties":{"statusCode":{"type":"integer","example":401,"description":"the http error code returned."},"error":{"type":"string","example":"Unauthorized","description":"a brief description of the error"},"txId":{"type":"string","example":"86e189a6-0124-47d3-a32c-25ff3f07deaf","description":"a unique hex number that can be used for debugging"}}}}}},"Forbidden":{"description":"Forbidden- The token is invalid","content":{"*/*":{"schema":{"type":"object","minProperties":1,"required":["message"],"properties":{"message":{"type":"string","example":"Invalid authentication credentials","description":"a brief description of the error"}}}}}},"BadRequest":{"description":"Validation Error","content":{"*/*":{"schema":{"type":"object","minProperties":3,"required":["statusCode","error","txId"],"properties":{"statusCode":{"type":"integer","example":400,"description":"the http error code returned."},"error":{"type":"string","example":"Validation Error","description":"a brief description of the error"},"txId":{"type":"string","example":"86e189a6-0124-47d3-a32c-25ff3f07deaf","description":"a unique hex number that can be used for debugging"},"validationErrors":{"type":"object","properties":{"someProperty":{"type":"string","example":"must not be empty","description":"the name of the property failing validation."}}}}}}}},"ServerError":{"description":"Error- This request could not be processed by the server","content":{"*/*":{"schema":{"type":"object","minProperties":3,"required":["statusCode","error","txId"],"properties":{"statusCode":{"type":"integer","example":500,"description":"the http error code returned."},"error":{"type":"string","example":"Internal Server Error","description":"a brief description of the error"},"txId":{"type":"string","example":"86e189a6-0124-47d3-a32c-25ff3f07deaf","description":"a unique hex number that can be used for debugging"}}}}}}},"securitySchemes":{"BasicAuth":{"description":"Basic Authentication using the Key and Secret provided in the Umbrella UI.\nFull details are available here\nhttps://apps.na.collabserv.com/blogs/f87e608c-05c2-4a5c-a619-7bec47e506fb/entry/Umbrella_Management_API_Authentication?lang=en_us\n","type":"apiKey","name":"Authorization","in":"header"}},"schemas":{"NetworkDeviceCreate":{"type":"object","minProperties":4,"required":["model","macAddress","name","serialNumber"],"properties":{"model":{"type":"string","example":"ModelName","maxLength":128,"pattern":"[0-9A-Za-z_.-]{1,128}","description":"The model name of the device. Must be unique to your organization."},"macAddress":{"type":"string","example":"0123456789ab","maxLength":12,"minLength":12,"pattern":"[0-9A-Fa-f]{12}","description":"The MAC address of the device (formatted as 12 characters, no hyphens or colons). Must be unique."},"name":{"$ref":"#/components/schemas/name"},"serialNumber":{"type":"string","example":"12345a","maxLength":255,"description":"The serial number of the device"},"tag":{"type":"string","description":"A text tag that describes the device or this particular origin assigned to the device. Must be unique to your organization.","maxLength":50}}},"NetworkDevicePatch":{"type":"object","required":["name"],"properties":{"name":{"$ref":"#/components/schemas/name"}}},"NetworkDeviceEntityList":{"type":"array","items":{"$ref":"#/components/schemas/NetworkDeviceEntity"}},"NetworkDeviceEntity":{"type":"object","minProperties":9,"required":["originId","deviceId","deviceKey","name","serialNumber","createdAt","organizationId"],"properties":{"originId":{"type":"integer","example":35872943,"minimum":1,"description":"Umbrella wide unique identifier for this traffic source (origin). Used to manage the device, not used by the device itself."},"deviceId":{"type":"string","example":"0123456789abcdef","maxLength":16,"minLength":16,"pattern":"[0-9A-F]{16}","description":"The unique identifier for this specific Network Device. This is the identifier that should be inserted into EDNS packets."},"deviceKey":{"type":"string","example":"ModelName-0123456789ab","description":"A more descriptive unique identifier for the device. Not used by the device itself."},"name":{"type":"string","example":"APIDemoDevice","description":"The device’s name (typically matches the data in the POST).","minLength":1},"serialNumber":{"type":"string","example":"12345a","description":"The device’s serial number (typically matches the data in the POST)."},"createdAt":{"type":"string","example":"2017-09-22T04:18:51.000Z","description":"ISO8601 formatted timestamp that the device was created.","pattern":"^((?:[12][0-9]{3}))-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(\\.[0-9]{3})(Z)$"},"organizationId":{"type":"integer","example":1234,"minimum":1}}},"OriginPolicyAssociationList":{"type":"array","items":{"$ref":"#/components/schemas/OriginPolicyAssociation"}},"OriginPolicyAssociation":{"type":"object","minProperties":6,"required":["policyId","name","priority","isAppliedDirectly","isDefault","createdAt"],"properties":{"policyId":{"type":"integer","maxLength":64,"description":"Unique Id for this Policy","minimum":0},"name":{"type":"string","description":"Human readable name for the Policy as displayed in the Dashboard","example":"ApiDemoPolicy"},"priority":{"type":"integer","maxLength":64,"description":"Priority of this Policy","minimum":0},"isAppliedDirectly":{"type":"boolean","example":true,"description":"true if this Policy is directly applied to this Network Device, false if this Policy is indirectly applied to this Network Device, for example if it is the Default Policy or the Policy is applied to all Network Devices as a group."},"isDefault":{"type":"boolean","example":true,"description":"True if this is the default policy, otherwise false."},"createdAt":{"type":"string","example":"2017-09-22T04:18:51.000Z","description":"ISO8601 formatted timestamp that the Policy was created.","pattern":"^((?:[12][0-9]{3}))-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(\\.[0-9]{3})(Z)$"}}},"PolicyList":{"type":"array","items":{"$ref":"#/components/schemas/PolicyStub"}},"PolicyStub":{"type":"object","minProperties":7,"required":["policyId","organizationId","name","priority","createdAt","isDefault"],"properties":{"policyId":{"type":"integer","description":"Unique Id for this Policy","minimum":1},"organizationId":{"type":"integer","example":1234,"minimum":1},"name":{"type":"string","description":"Human readable name for the Policy as displayed in the Dashboard","example":"ApiDemoPolicy","minLength":1},"priority":{"type":"integer","description":"Priority of this Policy","minimum":0},"createdAt":{"type":"string","example":"2017-09-22T04:18:51.000Z","description":"ISO8601 formatted timestamp that the Policy was created.","pattern":"^((?:[12][0-9]{3}))-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(\\.[0-9]{3})(Z)$"},"isDefault":{"type":"boolean","example":true,"description":"True if this is the default policy, otherwise false."}}},"OrganizationsList":{"type":"array","items":{"type":"object","minProperties":2,"required":["organizationId","name"],"properties":{"organizationId":{"type":"integer","example":1234,"minimum":1},"name":{"type":"string","example":"API Demo Organization","description":"The name of this Organization. This is how the Organization is be designated in the Umbrella dashboard.","minLength":1}}}},"name":{"type":"string","example":"label1","maxLength":50,"description":"A name for the device. This is how the device will be designated in the customer’s Umbrella dashboard. This label should be unique to your organization."}}},"x-explorer-enabled":true,"x-proxy-enabled":true,"x-samples-enabled":true,"x-samples-languages":["curl","node","ruby","javascript","python"]}
