{"openapi":"3.0.0","info":{"title":"Network Tunnel Management APIs.","description":"Cloud Firewall Tunnel Config API","version":"1.0.0"},"paths":{"/service/tunnel/datacenters":{"get":{"summary":"Get a list of data centers","operationId":"datacenters","description":"Returns a list of data centers, including IP addresses and location information.","tags":["Data Center"],"responses":{"200":{"description":"Return data centers list","content":{"application/json":{"schema":{"type":"object","properties":{"continents":{"type":"array","items":{"type":"object","properties":{"cities":{"type":"array","items":{"type":"object","properties":{"latitude":{"type":"string","example":"52.354662"},"longitude":{"type":"string","example":"4.955532"},"name":{"type":"string","example":"Amsterdam"},"range":{"type":"string","example":"146.112.98.2/32"},"fqdn":{"type":"string","example":"eu2-b.vpn.sig.umbrella.com","description":"Only returns if fqdn associated with that city."}}}},"name":{"type":"string","example":"Europe"}}}}}}}}},"default":{"description":"Error with appropriate HTTP response code and error message.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","description":"Error message explaining the reason for failure."}}}}}}}}},"/organizations/{organizationId}/tunnels":{"parameters":[{"in":"path","name":"organizationId","description":"The ID of the organization","required":true,"schema":{"type":"integer"}}],"get":{"summary":"List Organization tunnels","operationId":"listTunnels","description":"Provides a list of tunnels for an Organization","tags":["Organization Tunnel"],"parameters":[{"in":"query","name":"limit","description":"Optional parameter detailing the number of tunnels returned on request. If not passed, all tunnels returned on default.","required":false,"schema":{"type":"integer"}},{"in":"query","name":"startKey","description":"Optional parameter to tell the request where to start the return of tunnels from (key correlates to first tunnel to return). If not passed, tunnel read collection return starts from the first tunnel available. startKey for next request is returned as a value in the hypermedia Link header on a request where limit is passed and full number of tunnels not yet parsed","required":false,"schema":{"type":"string"}},{"in":"query","name":"filters","description":"Optional parameter to filter the tunnel list by tunnel name or device type. For example {\"name\":\"test\",\"deviceType\":\"ISR\"}","required":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"Return a list of tunnels associated with an Organization","headers":{"Total-Item-Count":{"description":"Number of total active tunnels in organization. ex. \"500\"","schema":{"type":"string"}},"Link":{"description":"Hypermedia links in string format. Used to provide parameters for pagination. Only available if request purposely limits number of tunnels returned. Link provided is relative path. \"rel\" value here is always \"next\" (pagination moves forward).","schema":{"type":"string"}}},"content":{"application/json":{"schema":{"type":"array","items":{"type":"object","description":"Tunnel resource object","properties":{"id":{"type":"integer","readOnly":true,"description":"Tunnel resource ID, use this ID as reference for subsequent requests","example":1122321},"uri":{"type":"string","description":"Resource URI","readOnly":true,"example":"/organization/2345432/tunnels/1122321"},"name":{"type":"string","description":"Display name given to the tunnel","example":"Site01Tunnel"},"client":{"type":"object","description":"Configuration metadata of the client","properties":{"deviceType":{"type":"string","description":"The type of device from where the tunnel will be established","enum":["ASA","ISR","Meraki MX","Viptela cEdge","Viptela vEdge","other"],"example":"ASA"},"authentication":{"type":"object","description":"Authentication context of client","properties":{"type":{"type":"string","enum":["PSK"],"example":"PSK","readOnly":true},"parameters":{"type":"object","properties":{"id":{"type":"string","description":"PSK ID. If an IP address is used as the ID, the IP address itself will be returned in this field.","readOnly":true,"example":"admin@2561066-237952254-umbrella.com"},"modifiedAt":{"type":"string","format":"dateTime","readOnly":true,"example":"2018-06-13T16:07:07.222Z"}}}}}}},"transport":{"type":"object","properties":{"protocol":{"description":"Tunnel transport protocol, default is IPSec.","type":"string","enum":["IPSec"],"readOnly":true,"example":"IPSec"}}},"resourceAttributes":{"description":"Metadata associated with this tunnel.","type":"object","additionalProperties":{"type":"string","minimum":1,"maximum":10},"example":{"viptela:siteId":"site-02","viptela:deviceId":123456}},"meta":{"type":"object","description":"Metadata for the tunnel object, relating to service internals.","readOnly":true,"properties":{"networkId":{"type":"integer","description":"The ID of the network (IP address) used as the PSK ID of the tunnel. Only present if an IP address was used as the PSK ID."}}},"createdAt":{"type":"string","format":"dateTime","readOnly":true,"example":"2018-06-13T16:07:07.222Z"},"modifiedAt":{"type":"string","format":"dateTime","readOnly":true,"example":"2018-06-13T16:07:07.222Z"}}}}}}},"default":{"description":"Error with appropriate HTTP response code and error message.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","description":"Error message explaining the reason for failure."}}}}}}}},"post":{"summary":"Create a new tunnel","operationId":"addTunnel","description":"Adds a new tunnel to the Organization","tags":["Organization Tunnel"],"requestBody":{"content":{"application/json":{"schema":{"properties":{"name":{"type":"string","description":"Human-readable name to give the tunnel"},"deviceType":{"type":"string","description":"The device type from which the tunnel originates, default is \"other\".","enum":["ASA","ISR","Meraki MX","Viptela cEdge","Viptela vEdge","other"]},"transport":{"type":"object","properties":{"protocol":{"description":"Tunnel transport protocol, default is IPSec.","type":"string","enum":["IPSec"],"example":"IPSec"}}},"authentication":{"type":"object","properties":{"type":{"type":"string","description":"The authentication method, default is PSK.","enum":["PSK"]},"parameters":{"type":"object","properties":{"idPrefix":{"type":"string","description":"A human-readable ID for the tunnel, used to generate the ID portion of the Pre-Shared Key. If omitted, id will be generated and provided in response. Tunnels with a Device Type of ASA must provide an IP address string for this field. Tunnels with a Device Type of \"other\" may use either an IP address or a human-readable string. PSK IDs will not be automatically generated for ASA devices."},"secret":{"type":"string","description":"The secret portion of a Pre-Shared Key. If omitted, a secret will be generated and provided in the response. (16-64 characters, at least 1 upper and lowercase letter, 1 numeral, no special characters)."}}}}},"resourceAttributes":{"description":"Metadata associated with this tunnel.","type":"object","additionalProperties":{"type":"string","minimum":1,"maximum":10},"example":{"viptela:siteId":"site-02","viptela:deviceId":123456}}},"required":["name"]}}},"description":"The tunnel to create"},"responses":{"200":{"description":"Tunnel created","content":{"application/json":{"schema":{"allOf":[{"type":"object","description":"Tunnel resource object","properties":{"id":{"type":"integer","readOnly":true,"description":"Tunnel resource ID, use this ID as reference for subsequent requests","example":1122321},"uri":{"type":"string","description":"Resource URI","readOnly":true,"example":"/organization/2345432/tunnels/1122321"},"name":{"type":"string","description":"Display name given to the tunnel","example":"Site01Tunnel"},"client":{"type":"object","description":"Configuration metadata of the client","properties":{"deviceType":{"type":"string","description":"The type of device from where the tunnel will be established","enum":["ASA","ISR","Meraki MX","Viptela cEdge","Viptela vEdge","other"],"example":"ASA"},"authentication":{"type":"object","description":"Authentication context of client","properties":{"type":{"type":"string","enum":["PSK"],"example":"PSK","readOnly":true},"parameters":{"type":"object","properties":{"id":{"type":"string","description":"PSK ID. If an IP address is used as the ID, the IP address itself will be returned in this field.","readOnly":true,"example":"admin@2561066-237952254-umbrella.com"},"modifiedAt":{"type":"string","format":"dateTime","readOnly":true,"example":"2018-06-13T16:07:07.222Z"}}}}}}},"transport":{"type":"object","properties":{"protocol":{"description":"Tunnel transport protocol, default is IPSec.","type":"string","enum":["IPSec"],"readOnly":true,"example":"IPSec"}}},"resourceAttributes":{"description":"Metadata associated with this tunnel.","type":"object","additionalProperties":{"type":"string","minimum":1,"maximum":10},"example":{"viptela:siteId":"site-02","viptela:deviceId":123456}},"meta":{"type":"object","description":"Metadata for the tunnel object, relating to service internals.","readOnly":true,"properties":{"networkId":{"type":"integer","description":"The ID of the network (IP address) used as the PSK ID of the tunnel. Only present if an IP address was used as the PSK ID."}}},"createdAt":{"type":"string","format":"dateTime","readOnly":true,"example":"2018-06-13T16:07:07.222Z"},"modifiedAt":{"type":"string","format":"dateTime","readOnly":true,"example":"2018-06-13T16:07:07.222Z"}}},{"type":"object","properties":{"client":{"type":"object","properties":{"authentication":{"type":"object","properties":{"parameters":{"type":"object","properties":{"secret":{"type":"string","description":"The secret of the PSK credentials. This is the only time the system will provide this value. Please make sure to save it.","example":"This123Secret"}}}}}}}}}]}}}},"401":{"description":"Unauthorized - Please check response body for error message explaining the reason for failure from the list.","content":{"application/json":{"schema":{"allOf":[{"type":"object","properties":{"error":{"type":"string","description":"Error message explaining the reason for failure."}}},{"type":"object","properties":{"error":{"type":"string","description":"Error message explaining the reason for failure from the list.","example":["API credential is invalid."]}}}]}}}},"403":{"description":"Forbidden - Please check response body for error message explaining the reason for failure from the list.","content":{"application/json":{"schema":{"allOf":[{"type":"object","properties":{"error":{"type":"string","description":"Error message explaining the reason for failure."}}},{"type":"object","properties":{"error":{"type":"string","description":"Error message explaining the reason for failure from the list.","example":["SIG is not enabled, please check with Cisco Support if needed.","You have reached the maximum number of network tunnels for this organization. To increase the limit, contact your administrator."]}}}]}}}},"default":{"description":"Error with appropriate HTTP response code and error message.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","description":"Error message explaining the reason for failure."}}}}}}}}},"/organizations/{organizationId}/tunnels/{id}":{"parameters":[{"in":"path","name":"organizationId","description":"The ID of the organization","required":true,"schema":{"type":"integer"}},{"in":"path","name":"id","description":"The ID of the tunnel","required":true,"schema":{"type":"integer"}}],"get":{"summary":"Get a specific tunnel","operationId":"getTunnel","description":"Return the details of a specific tunnel","tags":["Organization Tunnel"],"responses":{"200":{"description":"Return a tunnel","content":{"application/json":{"schema":{"type":"object","description":"Tunnel resource object","properties":{"id":{"type":"integer","readOnly":true,"description":"Tunnel resource ID, use this ID as reference for subsequent requests","example":1122321},"uri":{"type":"string","description":"Resource URI","readOnly":true,"example":"/organization/2345432/tunnels/1122321"},"name":{"type":"string","description":"Display name given to the tunnel","example":"Site01Tunnel"},"client":{"type":"object","description":"Configuration metadata of the client","properties":{"deviceType":{"type":"string","description":"The type of device from where the tunnel will be established","enum":["ASA","ISR","Meraki MX","Viptela cEdge","Viptela vEdge","other"],"example":"ASA"},"authentication":{"type":"object","description":"Authentication context of client","properties":{"type":{"type":"string","enum":["PSK"],"example":"PSK","readOnly":true},"parameters":{"type":"object","properties":{"id":{"type":"string","description":"PSK ID. If an IP address is used as the ID, the IP address itself will be returned in this field.","readOnly":true,"example":"admin@2561066-237952254-umbrella.com"},"modifiedAt":{"type":"string","format":"dateTime","readOnly":true,"example":"2018-06-13T16:07:07.222Z"}}}}}}},"transport":{"type":"object","properties":{"protocol":{"description":"Tunnel transport protocol, default is IPSec.","type":"string","enum":["IPSec"],"readOnly":true,"example":"IPSec"}}},"resourceAttributes":{"description":"Metadata associated with this tunnel.","type":"object","additionalProperties":{"type":"string","minimum":1,"maximum":10},"example":{"viptela:siteId":"site-02","viptela:deviceId":123456}},"meta":{"type":"object","description":"Metadata for the tunnel object, relating to service internals.","readOnly":true,"properties":{"networkId":{"type":"integer","description":"The ID of the network (IP address) used as the PSK ID of the tunnel. Only present if an IP address was used as the PSK ID."}}},"createdAt":{"type":"string","format":"dateTime","readOnly":true,"example":"2018-06-13T16:07:07.222Z"},"modifiedAt":{"type":"string","format":"dateTime","readOnly":true,"example":"2018-06-13T16:07:07.222Z"}}}}}},"default":{"description":"Error with appropriate HTTP response code and error message.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","description":"Error message explaining the reason for failure."}}}}}}}},"delete":{"summary":"Delete a specific tunnel","operationId":"deleteTunnel","description":"Deletes a specific tunnel","tags":["Organization Tunnel"],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"detachPolicies":{"type":"boolean","default":true,"description":"When set to true, all associated policies will get detached from tunnel identity."}}}}}},"responses":{"200":{"description":"Tunnel deleted","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Tunnel deleted successfully"}}}}}},"default":{"description":"Error with appropriate HTTP response code and error message.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","description":"Error message explaining the reason for failure."}}}}}}}}},"/organizations/{organizationId}/tunnels/{id}/keys":{"parameters":[{"in":"path","name":"organizationId","description":"The ID of the organization","required":true,"schema":{"type":"integer"}},{"in":"path","name":"id","description":"The ID of the tunnel","required":true,"schema":{"type":"integer"}}],"post":{"summary":"Update and/or Rotate Tunnel Credentials","tags":["Organization Tunnel"],"operationId":"pskUpdate","requestBody":{"content":{"application/json":{"schema":{"properties":{"deprecateCurrentKeys":{"type":"boolean","default":false,"description":"When set to true, any existing valid credentials will be deprecated. 24hr window will not apply; existing keys will be deleted right away. Either both idPrefix and secret must be passed in OR autoRotate set to true (to generate). Default is false."},"autoRotate":{"type":"boolean","description":"Required value. When set to true, keys will be autogenerated. 24hr window will still apply and any passed in credentials ignored."},"psk":{"type":"object","properties":{"idPrefix":{"type":"string","description":"Required if autoRotate is set to false. To be concatenated with server side parameters to generate the ID for the Pre-Shared Key. If the value sent for idPrefix matches the current idPrefix, 24hr credential storage will be disabled. If the tunnel uses an IP address as the PSK ID this value must be an IP address string, it is required and autoRotate is disabled (cannot be true)."},"secret":{"type":"string","description":"The secret aspect of a Pre-Shared Key. Optional, but either idPrefix OR idPrefix and secret must be passed OR autoRotate set to true.  (16-64 characters, at least 1 upper and lowercase letter, 1 numeral, no special characters.)"}}}},"required":["autoRotate"]}}},"description":"The credentials and options for update and rotate. Will store previous credentials for 24hr window unless stated."},"responses":{"200":{"description":"Return a tunnel","content":{"application/json":{"schema":{"allOf":[{"type":"object","description":"Tunnel resource object","properties":{"id":{"type":"integer","readOnly":true,"description":"Tunnel resource ID, use this ID as reference for subsequent requests","example":1122321},"uri":{"type":"string","description":"Resource URI","readOnly":true,"example":"/organization/2345432/tunnels/1122321"},"name":{"type":"string","description":"Display name given to the tunnel","example":"Site01Tunnel"},"client":{"type":"object","description":"Configuration metadata of the client","properties":{"deviceType":{"type":"string","description":"The type of device from where the tunnel will be established","enum":["ASA","ISR","Meraki MX","Viptela cEdge","Viptela vEdge","other"],"example":"ASA"},"authentication":{"type":"object","description":"Authentication context of client","properties":{"type":{"type":"string","enum":["PSK"],"example":"PSK","readOnly":true},"parameters":{"type":"object","properties":{"id":{"type":"string","description":"PSK ID. If an IP address is used as the ID, the IP address itself will be returned in this field.","readOnly":true,"example":"admin@2561066-237952254-umbrella.com"},"modifiedAt":{"type":"string","format":"dateTime","readOnly":true,"example":"2018-06-13T16:07:07.222Z"}}}}}}},"transport":{"type":"object","properties":{"protocol":{"description":"Tunnel transport protocol, default is IPSec.","type":"string","enum":["IPSec"],"readOnly":true,"example":"IPSec"}}},"resourceAttributes":{"description":"Metadata associated with this tunnel.","type":"object","additionalProperties":{"type":"string","minimum":1,"maximum":10},"example":{"viptela:siteId":"site-02","viptela:deviceId":123456}},"meta":{"type":"object","description":"Metadata for the tunnel object, relating to service internals.","readOnly":true,"properties":{"networkId":{"type":"integer","description":"The ID of the network (IP address) used as the PSK ID of the tunnel. Only present if an IP address was used as the PSK ID."}}},"createdAt":{"type":"string","format":"dateTime","readOnly":true,"example":"2018-06-13T16:07:07.222Z"},"modifiedAt":{"type":"string","format":"dateTime","readOnly":true,"example":"2018-06-13T16:07:07.222Z"}}},{"type":"object","properties":{"client":{"type":"object","properties":{"authentication":{"type":"object","properties":{"parameters":{"type":"object","properties":{"secret":{"type":"string","description":"The secret of the PSK credentials. This is the only time the system will provide this value. Please make sure to save it.","example":"This123Secret"}}}}}}}}}]}}}},"default":{"description":"Error with appropriate HTTP response code and error message.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","description":"Error message explaining the reason for failure."}}}}}}}}},"/organizations/{organizationId}/tunnels/{id}/policies":{"parameters":[{"in":"path","name":"organizationId","description":"The ID of the organization.","required":true,"schema":{"type":"integer"}},{"in":"path","name":"id","description":"The ID of the tunnel.","required":true,"schema":{"type":"integer"}},{"in":"query","name":"type","description":"Filter the list of policies to only the specified type.","required":false,"schema":{"type":"string","enum":["firewallrule","web"]}},{"in":"query","name":"limit","description":"The number of items to return.","required":false,"schema":{"type":"integer"}},{"in":"query","name":"page","description":"The page number to request. Use along with the limit parameter to implement pagination.","required":false,"schema":{"type":"integer"}}],"get":{"summary":"Get information about all policies that make use of the tunnel.","operationId":"getTunnelPolicies","description":"Return a list of every policy that uses the tunnel.","tags":["Organization Tunnel"],"responses":{"200":{"description":"Return policies associated with a tunnel.","content":{"application/json":{"schema":{"type":"array","description":"Policies associated with a tunnel","readOnly":true,"items":{"type":"object","readOnly":true,"properties":{"id":{"type":"integer","description":"Resource ID, use this ID as reference for subsequent requests.","example":1122321},"type":{"type":"string","description":"A string specifying the type of policy.","enum":["firewallrule","web"]},"name":{"type":"string","description":"Human-readable name given to the policy.","example":"Test Firewall Rule (Block Application)"},"organizationId":{"type":"integer","description":"An Umbrella Organization ID","example":33451234},"priority":{"type":"integer","description":"An integer representing the position of the policy in the policy list.","example":4},"isDefault":{"type":"boolean","description":"Indicates if this is the default policy."},"isAppliedDirectly":{"type":"boolean","description":"True if the tunnel is applied directly to this policy, false if the policy is configured to use all tunnels."},"createdAt":{"type":"string","format":"dateTime","example":"2018-06-13T16:07:07.222Z"},"modifiedAt":{"type":"string","format":"dateTime","example":"2018-06-13T16:07:07.222Z"},"uri":{"type":"string","description":"Resource URI","example":"/v1/organizations/1234567/tunnels/8765432/policies"}}}}}}},"default":{"description":"Error with appropriate HTTP response code and error message.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","description":"Error message explaining the reason for failure."}}}}}}}}}},"security":[{"apiKeys":[]}],"servers":[{"url":"https://management.api.umbrella.com/v1"}],"components":{"securitySchemes":{"apiKeys":{"type":"http","scheme":"basic"}}},"x-explorer-enabled":true,"x-proxy-enabled":true,"x-samples-enabled":true,"x-samples-languages":["curl","node","ruby","javascript","python"]}
